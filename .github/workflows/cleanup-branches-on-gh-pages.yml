name: Cleanup Orphaned Branch Deployments

on:
  schedule:
    - cron: '0 3 * * *'
  workflow_dispatch:

permissions:
  contents: write

jobs:
  cleanup:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“¦ Checkout gh-pages branch
        uses: actions/checkout@v4
        with:
          ref: gh-pages
          fetch-depth: 0

      - name: ğŸ“ List all current branches
        run: |
          echo "Current remote branches:"
          git fetch origin
          git branch -r | grep 'origin/' | grep -v 'origin/gh-pages' | sed 's|origin/||'

      - name: ğŸ“‚ List all files and folders in gh-pages branch
        run: |
          echo "Files and folders in gh-pages branch:"
          ls -lhA
          echo
          echo "Directories in gh-pages branch:"
          find . -maxdepth 1 -type d | sort